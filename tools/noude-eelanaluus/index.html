<!doctype html>
<html lang="et">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NÃµude eelanalÃ¼Ã¼s â€” Solvere Lab</title>
  <link rel="stylesheet" href="/assets/site.css" />

<!-- Privacy-friendly analytics by Plausible -->
<script async src="https://plausible.io/js/pa-pjc0qZXxUiq_r44m96Ana.js"></script>
<script>
  window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
  plausible.init()
</script>

<!-- Language switcher logic (ET / RU) -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const isRU = location.pathname.startsWith("/ru/");
  const current = isRU ? "ru" : "et";

  document.querySelectorAll(".langswitch a[data-lang]").forEach(a => {
    a.classList.toggle("active", a.dataset.lang === current);
  });
});
</script>
</head>

<body class="page-tool">
<main class="container" id="app">

  <!-- Language switch (global) -->
<nav class="langswitch">
  <a href="/" data-lang="et">ET</a>
  <span>Â·</span>
  <a href="/ru/" data-lang="ru">RU</a>
</nav>

  <!-- Tool navigation -->
<nav class="tool-nav" aria-label="Sekundaarne navigatsioon">
  <a href="/" class="tool-nav__link">â† Avaleht</a>
  <span class="tool-nav__sep">Â·</span>
  <a href="/metoodika/" class="tool-nav__link">Metoodika</a>
</nav>
  
  <!-- HEADER / INTRO -->
  <header class="pagehead">
    <h1>NÃµude eelanalÃ¼Ã¼s</h1>
    <p class="lead">
  Struktureeritud eelanalÃ¼Ã¼s enne kohtusse pÃ¶Ã¶rdumist: mida Te teiselt poolelt nÃµuate, peamised riskid ja tÃµendite piisavus.
</p>

    <div class="notice notice--neutral" role="note" aria-label="Oluline mÃ¤rkus">
      Tegemist on informatiivse eelanalÃ¼Ã¼si tÃ¶Ã¶riistaga. See ei asenda individuaalset ÃµigusnÃµustamist ega prognoosi menetluse tulemust.
      Vastused salvestuvad Ã¼ksnes Teie brauseris ega edastata serverisse.
    </div>

   <div class="actions">
  <button type="button" class="btn btn-primary" id="btnStart">Alusta analÃ¼Ã¼si</button>
</div>
  </header>

  <!-- PROGRESS -->
  <section class="progresswrap" aria-label="Edenemine">
    <div class="progressbar" role="progressbar" aria-valuemin="0" aria-valuemax="6" aria-valuenow="0">
      <div class="progressbar__fill" id="progressFill" style="width:0%"></div>
    </div>
    <div class="progressmeta">
      <span id="progressLabel">Samm 0 / 6</span>
    </div>
  </section>

  <!-- STEPS (single page, step-by-step) -->
  <section class="steps" id="steps" aria-label="KÃ¼simustik" hidden>

   <!-- STEP 1 -->
<article class="step" data-step="1" aria-labelledby="s1-title" hidden>
  <header class="step__head">
    <h2 id="s1-title">1. Mida Te teiselt poolelt nÃµuate?</h2>

    <!-- Question-level help -->
<button type="button" class="helpBtn"
        data-help="s1-help"
        aria-expanded="false"
        aria-controls="s1-help"
        aria-label="Ava selgitus">
</button>
  </header>

  <div class="helpPanel" id="s1-help" hidden>
    <p><strong>Lihtsas keeles:</strong> vali, milline olukord on Sinu juhtumile kÃµige lÃ¤hem.</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> see aitab hinnata, kui selge on nÃµude sisu ja milline on tÃµendamisrisk.</p>
    <p class="muted"><strong>NÃ¤ide:</strong> â€œmaksin, aga ei saanud teenustâ€ vs â€œtÃ¶Ã¶ jÃ¤i tegemataâ€ vs â€œtekitati kahjuâ€.</p>
  </div>

  <fieldset class="q" aria-label="NÃµude sisu kÃ¼simus">
    <legend class="q__legend">Vali kÃµige sobivam kirjeldus</legend>

    <!-- OPTION 3 -->
    <label class="opt">
      <input type="radio" name="basis" value="3" />
      <span class="opt__text">
        <span>Jah â€” meil on kirjalik kokkulepe (leping, e-kiri vÃµi sÃµnumid) ja on selge, mida teine pool pidi tegema.</span>

        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s1-o3"
                aria-expanded="false"
                aria-controls="s1-o3"
                aria-label="Mis loeb kirjalikuks?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s1-o3" hidden>
      <p><strong>Mis loeb kirjalikuks?</strong> allkirjastatud leping, tellimus + kinnitus, e-kirjad, sÃµnumid, arve aktsepteerimisega.</p>
      <p class="muted"><strong>Miks oluline:</strong> vÃ¤hendab vaidlust selle Ã¼le, mis kokku lepiti.</p>
    </div>

    <!-- OPTION 2 -->
    <label class="opt">
      <input type="radio" name="basis" value="2" />
      <span class="opt__text">
        <span>Jah â€” kokkulepe oli suuline, kuid kohustus ja tingimused on siiski Ã¼sna selged.</span>

        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s1-o2"
                aria-expanded="false"
                aria-controls="s1-o2"
                aria-label="Kuidas suulist kokkulepet hinnata?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s1-o2" hidden>
      <p><strong>NÃ¤ited, mis aitavad:</strong> pealtnÃ¤gijad, hilisem kirjavahetus, maksed, tÃ¶Ã¶ Ã¼leandmine, varasem praktika.</p>
      <p class="muted"><strong>Miks oluline:</strong> vÃµimalik, kuid tÃµendamisrisk on suurem kui kirjaliku kokkuleppe korral.</p>
    </div>

    <!-- OPTION 1 -->
    <label class="opt">
      <input type="radio" name="basis" value="1" />
      <span class="opt__text">
        <span>Osaliselt â€” midagi oli kokku lepitud, aga tingimused (mis, millal, kui palju) ei ole selged.</span>

        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s1-o1"
                aria-expanded="false"
                aria-controls="s1-o1"
                aria-label="Mida tÃ¤psustada?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s1-o1" hidden>
      <p><strong>Mida tÃ¤psustada:</strong> kes pidi mida tegema, mis ajaks, mis hinnaga/mahus, millistel tingimustel.</p>
      <p class="muted"><strong>Miks oluline:</strong> kui sisu on ebaselge, vÃµib nÃµue muutuda vaieldavaks.</p>
    </div>

    <!-- OPTION 0 -->
    <label class="opt">
      <input type="radio" name="basis" value="0" />
      <span class="opt__text">
        <span>Ei â€” mul ei ole selget kokkulepet/kohustust, millele nÃµue toetub.</span>

        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s1-o0"
                aria-expanded="false"
                aria-controls="s1-o0"
                aria-label="Millal see variant sobib?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s1-o0" hidden>
      <p><strong>Millal sobib:</strong> nÃ¤iteks raha kanti Ã¼le eksituse tÃµttu vÃµi puudub arusaadav alus, miks teine pool â€œpeabâ€.</p>
      <p class="muted"><strong>Miks oluline:</strong> vÃµib viidata teistsugusele alusele (nt alusetu rikastumine), kuid risk on kÃµrgem.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back" disabled>Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="next">JÃ¤rgmine</button>
  </footer>
</article>

    <!-- STEP 2 -->
<article class="step" data-step="2" aria-labelledby="s2-title" hidden>
  <header class="step__head">
    <h2 id="s2-title">2. Kas teine pool jÃ¤ttis kokkuleppe tÃ¤itmata?</h2>

    <button type="button"
            class="helpBtn"
            data-help="s2-help"
            aria-expanded="false"
            aria-controls="s2-help"
            aria-label="Ava selgitus">
      ?
    </button>
  </header>

  <div class="helpPanel" id="s2-help" hidden>
    <p><strong>Lihtsas keeles:</strong> kas lubatu jÃ¤i tegemata, tehti halvasti vÃµi tehti liiga hilja.</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> nÃµue on tugevam, kui rikkumine on selgelt kirjeldatav ja seostatav konkreetse kokkuleppega.</p>
    <p class="muted"><strong>NÃ¤ide:</strong> â€œei tarnitudâ€, â€œtehti puudulikultâ€, â€œhilines 2 kuudâ€.</p>
  </div>

  <fieldset class="q" aria-label="Rikkumise kÃ¼simus">
    <legend class="q__legend">Vali kÃµige sobivam kirjeldus</legend>

    <label class="opt">
      <input type="radio" name="breach" value="3" />
      <span class="opt__text">
        <span>Jah â€” rikkumine on selge ja seda toetavad dokumendid vÃµi muud tÃµendid.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s2-o3"
                aria-expanded="false"
                aria-controls="s2-o3"
                aria-label="NÃ¤ited">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s2-o3" hidden>
      <p><strong>NÃ¤ited:</strong> kirjavahetus â€œei teinud/ei saanudâ€, aktid, fotod, kauba mittesaabumine, hilinemise kuupÃ¤evad.</p>
      <p class="muted"><strong>Miks oluline:</strong> vÃ¤hendab vaidlust â€œkas Ã¼ldse rikutiâ€.</p>
    </div>

    <label class="opt">
      <input type="radio" name="breach" value="2" />
      <span class="opt__text">
        <span>Ilmselt jah â€” rikkumine on usutav, kuid kÃµik ei ole veel dokumenteeritud.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s2-o2"
                aria-expanded="false"
                aria-controls="s2-o2"
                aria-label="Mida juurde koguda?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s2-o2" hidden>
      <p><strong>Mida juurde koguda:</strong> kuupÃ¤evad, sÃµnumid, tÃ¶Ã¶ Ã¼leandmise puudumine, arved, tÃµendid tehtud maksete kohta.</p>
      <p class="muted"><strong>Miks oluline:</strong> keskmine risk â€” sageli lahendatav parema kronoloogia ja tÃµenditega.</p>
    </div>

    <label class="opt">
      <input type="radio" name="breach" value="1" />
      <span class="opt__text">
        <span>Vaidlus on vÃµimalik â€” teine pool vÃµib vÃ¤ita, et rikkumist ei olnud vÃµi see oli Ãµigustatud.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s2-o1"
                aria-expanded="false"
                aria-controls="s2-o1"
                aria-label="Millal on vaieldav?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s2-o1" hidden>
      <p><strong>Millal on vaieldav:</strong> tÃ¶Ã¶ kvaliteet on hinnanguline, tÃ¤htajad polnud kokku lepitud, pooled mÃµistsid kokkulepet erinevalt.</p>
      <p class="muted"><strong>Miks oluline:</strong> kÃµrgem risk â€” vaja tÃ¤psustada, mis tÃ¤pselt oli lubatud.</p>
    </div>

    <label class="opt">
      <input type="radio" name="breach" value="0" />
      <span class="opt__text">
        <span>Ei ole kindel â€” ma ei saa selgelt Ã¶elda, mida ja kuidas rikuti.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s2-o0"
                aria-expanded="false"
                aria-controls="s2-o0"
                aria-label="Mida teha, kui pole kindel?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s2-o0" hidden>
      <p><strong>Kui pole kindel:</strong> kirjuta 5â€“8 lausega faktid (mis juhtus, millal, mida ootasid) ja kogu esmased tÃµendid.</p>
      <p class="muted"><strong>Miks oluline:</strong> ilma rikkumise kirjelduseta on nÃµude â€œsÃ¼daâ€ nÃµrk.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back">Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="next">JÃ¤rgmine</button>
  </footer>
</article>

    <!-- STEP 3 -->
<article class="step" data-step="3" aria-labelledby="s3-title" hidden>
  <header class="step__head">
    <h2 id="s3-title">3. Kas nÃµude summa on selge ja pÃµhjendatav?</h2>

    <button type="button"
            class="helpBtn"
            data-help="s3-help"
            aria-expanded="false"
            aria-controls="s3-help"
            aria-label="Ava selgitus">
      ?
    </button>
  </header>

  <div class="helpPanel" id="s3-help" hidden>
    <p><strong>Lihtsas keeles:</strong> kas Sa oskad Ã¶elda, kui palju tÃ¤pselt nÃµuad ja millest see summa koosneb.</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> kui summa on ebamÃ¤Ã¤rane, on nÃµue vaieldavam ja planeerimine keerulisem.</p>
    <p class="muted"><strong>NÃ¤ide:</strong> â€œarve 480 â‚¬ + paranduskulu 120 â‚¬â€ on tugevam kui â€œumbes 1000 â‚¬â€.</p>
  </div>

  <fieldset class="q" aria-label="Summa kÃ¼simus">
    <legend class="q__legend">Vali kÃµige sobivam kirjeldus</legend>

    <label class="opt">
      <input type="radio" name="damage" value="3" />
      <span class="opt__text">
        <span>Jah â€” summa on tÃ¤pselt arvutatav ja mul on selleks alus (arved, leping, arvestus).</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s3-o3"
                aria-expanded="false"
                aria-controls="s3-o3"
                aria-label="NÃ¤ited">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s3-o3" hidden>
      <p><strong>NÃ¤ited:</strong> konkreetne arve, maksekorraldus, hinnapakkumine, remondiarve, selge arvutuskÃ¤ik.</p>
      <p class="muted"><strong>Miks oluline:</strong> vÃ¤hendab vaidlust â€œkui palju tegelikultâ€.</p>
    </div>

    <label class="opt">
      <input type="radio" name="damage" value="2" />
      <span class="opt__text">
        <span>Osaliselt â€” summa on ligikaudu arvutatav, aga kÃµik dokumendid/andmed pole koos.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s3-o2"
                aria-expanded="false"
                aria-controls="s3-o2"
                aria-label="Mida puudu vÃµib olla?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s3-o2" hidden>
      <p><strong>Mis vÃµib puudu olla:</strong> tÃ¤psed kuludokumendid, perioodid, tÃ¶Ã¶maht, paranduskulude tÃµendid.</p>
      <p class="muted"><strong>Miks oluline:</strong> keskmine risk â€” sageli parandatav dokumentide koondamisega.</p>
    </div>

    <label class="opt">
      <input type="radio" name="damage" value="1" />
      <span class="opt__text">
        <span>Ei ole selge â€” ma ei oska summat piisavalt tÃ¤pselt kokku panna.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s3-o1"
                aria-expanded="false"
                aria-controls="s3-o1"
                aria-label="Kuidas alustada?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s3-o1" hidden>
      <p><strong>Kuidas alustada:</strong> erista pÃµhivÃµlg (raha) ja muud kulud (kahju, lisakulud). Tee lihtne tabel: kulu, summa, dokument.</p>
      <p class="muted"><strong>Miks oluline:</strong> kÃµrgem risk â€” ilma selge summata on nÃµude maksmapanek raskem.</p>
    </div>

    <label class="opt">
      <input type="radio" name="damage" value="0" />
      <span class="opt__text">
        <span>Puudub â€” nÃµude summa ei ole praegu rahaliselt mÃ¤Ã¤ratletud.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s3-o0"
                aria-expanded="false"
                aria-controls="s3-o0"
                aria-label="Millal see variant sobib?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s3-o0" hidden>
      <p><strong>Millal sobib:</strong> nÃ¤iteks emotsionaalne kahju ilma arvestuseta vÃµi puuduvad kuludokumendid.</p>
      <p class="muted"><strong>Miks oluline:</strong> kriitiline risk â€” vaja esmalt summa kokku panna.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back">Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="next">JÃ¤rgmine</button>
  </footer>
</article>

    <!-- STEP 4 (weighted x2) -->
<article class="step step--weighted" data-step="4" aria-labelledby="s4-title" hidden>
  <header class="step__head">
    <h2 id="s4-title">4. Millised tÃµendid Sul on?</h2>

    <button type="button"
            class="helpBtn"
            data-help="s4-help"
            aria-expanded="false"
            aria-controls="s4-help"
            aria-label="Ava selgitus">
      ?
    </button>
  </header>

  <div class="helpPanel" id="s4-help" hidden>
    <p><strong>Lihtsas keeles:</strong> tÃµendid on asjad, mis kinnitavad Sinu juttu (dokumendid, sÃµnumid, fotod).</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> kohtuvaidluses loevad faktid ja tÃµendid â€” see on Ã¼ks tugevamaid riskitegureid.</p>
    <p class="muted"><strong>NÃ¤ited:</strong> leping, arve, e-kirjad, sÃµnumid, fotod, Ã¼lekanded, Ã¼leandmisakt.</p>
  </div>

  <fieldset class="q" aria-label="TÃµendite kÃ¼simus">
    <legend class="q__legend">Vali kÃµige sobivam kirjeldus</legend>

    <label class="opt">
      <input type="radio" name="evidence" value="3" />
      <span class="opt__text">
        <span>Mul on mitu tugevat tÃµendit (dokumendid, kirjavahetus, objektiivsed andmed).</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s4-o3"
                aria-expanded="false"
                aria-controls="s4-o3"
                aria-label="Mis on tugev tÃµend?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s4-o3" hidden>
      <p><strong>Tugev tÃµend:</strong> nÃ¤itab kohustust + rikkumist + summat (vÃµi vÃ¤hemalt kahte neist) ning on ajaliselt loogiline.</p>
      <p class="muted"><strong>Tip:</strong> koonda tÃµendid kronoloogilisse kausta.</p>
    </div>

    <label class="opt">
      <input type="radio" name="evidence" value="2" />
      <span class="opt__text">
        <span>MÃµned tÃµendid on olemas, aga mitte kÃµige kohta.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s4-o2"
                aria-expanded="false"
                aria-controls="s4-o2"
                aria-label="Mis vÃµiks puudu olla?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s4-o2" hidden>
      <p><strong>Mis vÃµib puudu olla:</strong> kokkuleppe detailid, kuupÃ¤evad, tÃ¶Ã¶ Ã¼leandmise jÃ¤lg, kuludokumendid.</p>
      <p class="muted"><strong>Miks oluline:</strong> keskmine risk â€” sageli parandatav lisatÃµenditega.</p>
    </div>

    <label class="opt">
      <input type="radio" name="evidence" value="1" />
      <span class="opt__text">
        <span>TÃµendeid on vÃ¤he vÃµi need on pigem kaudsed (nt ainult suusÃµnaline info).</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s4-o1"
                aria-expanded="false"
                aria-controls="s4-o1"
                aria-label="Mis on kaudne tÃµend?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s4-o1" hidden>
      <p><strong>Kaudne tÃµend:</strong> vihjab olukorrale, aga ei kinnita otse (nt Ã¼ldised sÃµnumid ilma tingimusteta).</p>
      <p class="muted"><strong>Miks oluline:</strong> kÃµrgem risk â€” vaja â€œotseâ€ tÃµendeid juurde.</p>
    </div>

    <label class="opt">
      <input type="radio" name="evidence" value="0" />
      <span class="opt__text">
        <span>TÃµendid puuduvad (praegu ei ole dokumente ega muud kinnitavat infot).</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s4-o0"
                aria-expanded="false"
                aria-controls="s4-o0"
                aria-label="Kas tÃµesti mitte midagi?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s4-o0" hidden>
      <p><strong>Kontrolli Ã¼le:</strong> maksekorraldused, sÃµnumid, fotod, kÃµnelogid, tunnistajad, varasemad arved.</p>
      <p class="muted"><strong>Miks oluline:</strong> kriitiline risk â€” ilma tÃµenditeta on vaidlus vÃ¤ga ebakindel.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back">Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="next">JÃ¤rgmine</button>
  </footer>
</article>

    <!-- STEP 5 -->
<article class="step" data-step="5" aria-labelledby="s5-title" hidden>
  <header class="step__head">
    <h2 id="s5-title">5. Mida teine pool vÃµib vastu vÃ¤ita?</h2>

    <button type="button"
            class="helpBtn"
            data-help="s5-help"
            aria-expanded="false"
            aria-controls="s5-help"
            aria-label="Ava selgitus">
      ?
    </button>
  </header>

  <div class="helpPanel" id="s5-help" hidden>
    <p><strong>Lihtsas keeles:</strong> â€œvastuvÃ¤ideâ€ on pÃµhjendus, miks teine pool Ã¼tleb, et ta ei pea maksma vÃµi tÃ¤itma.</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> isegi hea nÃµue vÃµib nÃµrgeneda, kui vastuvÃ¤ited on tugevad ja toetuvad faktidele.</p>
    <p class="muted"><strong>NÃ¤ide:</strong> â€œtÃ¶Ã¶ oli tehtudâ€, â€œkvaliteet oli okâ€, â€œte ise tÃ¼histasiteâ€, â€œaegumineâ€.</p>
  </div>

  <fieldset class="q" aria-label="VastuvÃ¤idete kÃ¼simus">
    <legend class="q__legend">Kui tÃµenÃ¤oline on, et teisel poolel on tugevad vastuvÃ¤ited?</legend>

    <label class="opt">
      <input type="radio" name="defenses" value="3" />
      <span class="opt__text">
        <span>VÃ¤hetÃµenÃ¤oline â€” ma ei nÃ¤e tugevaid pÃµhjendusi, millega ta saaks edukalt vastu vaielda.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s5-o3"
                aria-expanded="false"
                aria-controls="s5-o3"
                aria-label="Millal on vÃ¤hetÃµenÃ¤oline?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s5-o3" hidden>
      <p><strong>Millal:</strong> faktid ja dokumendid on selged, teine pool on vastuoluline vÃµi ei suuda selgitada.</p>
    </div>

    <label class="opt">
      <input type="radio" name="defenses" value="2" />
      <span class="opt__text">
        <span>VÃµimalik â€” tal vÃµib olla mÃµni argument, mis vajab lÃ¤bitÃ¶Ã¶tamist.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s5-o2"
                aria-expanded="false"
                aria-controls="s5-o2"
                aria-label="NÃ¤ited">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s5-o2" hidden>
      <p><strong>NÃ¤ited:</strong> â€œkvaliteet oli vaieldavâ€, â€œtÃ¤htaeg polnud kokku lepitudâ€, â€œte ise muutsid tingimusiâ€.</p>
      <p class="muted"><strong>Tip:</strong> pane kirja 2â€“3 vÃµimalikku vastuvÃ¤idet ja lisa juurde, mis neid Ã¼mber lÃ¼kkab.</p>
    </div>

    <label class="opt">
      <input type="radio" name="defenses" value="1" />
      <span class="opt__text">
        <span>TÃµenÃ¤oline â€” ta on juba esitanud argumente, mis vÃµivad olla veenvad.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s5-o1"
                aria-expanded="false"
                aria-controls="s5-o1"
                aria-label="Millal on tÃµenÃ¤oline?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s5-o1" hidden>
      <p><strong>Millal:</strong> dokumente on vÃ¤he, kokkulepe on ebaselge vÃµi on â€œsÃµna-sÃµna vastuâ€ olukord.</p>
    </div>

    <label class="opt">
      <input type="radio" name="defenses" value="0" />
      <span class="opt__text">
        <span>VÃ¤ga tÃµenÃ¤oline â€” tal on tugevad vastuvÃ¤ited ja/vÃµi olemas tÃµendid.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s5-o0"
                aria-expanded="false"
                aria-controls="s5-o0"
                aria-label="Miks kriitiline?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s5-o0" hidden>
      <p><strong>Miks kriitiline:</strong> vaidluse tulemus muutub ebakindlaks; vaja tÃµendibaasi ja vÃ¤idete struktuuri tugevdada.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back">Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="next">JÃ¤rgmine</button>
  </footer>
</article>

    <!-- STEP 6 (weighted x2) -->
<article class="step step--weighted" data-step="6" aria-labelledby="s6-title" hidden>
  <header class="step__head">
    <h2 id="s6-title">6. Kas on vÃµimalik, et nÃµue on aegunud vÃµi aegumas?</h2>

    <button type="button"
            class="helpBtn"
            data-help="s6-help"
            aria-expanded="false"
            aria-controls="s6-help"
            aria-label="Ava selgitus">
      ?
    </button>
  </header>

  <div class="helpPanel" id="s6-help" hidden>
    <p><strong>Lihtsas keeles:</strong> mÃµne nÃµude puhul ei saa pÃ¤rast teatud aja mÃ¶Ã¶dumist enam edukalt nÃµuda (tÃ¤htaeg saab tÃ¤is).</p>
    <p class="muted"><strong>Miks kÃ¼sime:</strong> aegumine vÃµib nÃµude maksmapanekut tugevalt piirata â€” see on kriitiline riskitegur.</p>
    <p class="muted"><strong>Praktiline tip:</strong> kui kuupÃ¤evad pole selged, vali pigem â€œVÃµimalikâ€.</p>
  </div>

  <fieldset class="q" aria-label="Aegumise kÃ¼simus">
    <legend class="q__legend">Vali kÃµige sobivam kirjeldus</legend>

    <label class="opt">
      <input type="radio" name="limitation" value="3" />
      <span class="opt__text">
        <span>Ei â€” juhtum on hiljutine ja kuupÃ¤evad on selged.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s6-o3"
                aria-expanded="false"
                aria-controls="s6-o3"
                aria-label="Mida tÃ¤hendab selge?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s6-o3" hidden>
      <p><strong>Selge:</strong> tead, millal pidi kohustus tÃ¤idetama / millal rikkumine toimus / millal kahju ilmnes.</p>
    </div>

    <label class="opt">
      <input type="radio" name="limitation" value="2" />
      <span class="opt__text">
        <span>EbatÃµenÃ¤oline â€” juhtum pole vana, aga kÃµik kuupÃ¤evad pole tÃ¤iesti kindlad.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s6-o2"
                aria-expanded="false"
                aria-controls="s6-o2"
                aria-label="Mida kontrollida?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s6-o2" hidden>
      <p><strong>Mida kontrollida:</strong> kirjavahetuse kuupÃ¤evad, arved, maksed, Ã¼leandmine, viimane kontakt.</p>
    </div>

    <label class="opt">
      <input type="radio" name="limitation" value="1" />
      <span class="opt__text">
        <span>VÃµimalik â€” kuupÃ¤evad on ebaselged vÃµi juhtum vÃµib olla vanem.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s6-o1"
                aria-expanded="false"
                aria-controls="s6-o1"
                aria-label="Miks valida see?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s6-o1" hidden>
      <p><strong>Miks valida:</strong> kui Sa ei ole kindel, on mÃµistlik kÃ¤sitleda seda riskina ja kontrollida kuupÃ¤evad Ã¼le.</p>
    </div>

    <label class="opt">
      <input type="radio" name="limitation" value="0" />
      <span class="opt__text">
        <span>TÃµenÃ¤oline â€” juhtum on vana vÃµi on selge aegumisoht.</span>
        <button type="button"
                class="helpBtn helpBtn--sm"
                data-help="s6-o0"
                aria-expanded="false"
                aria-controls="s6-o0"
                aria-label="Miks kriitiline?">
          ?
        </button>
      </span>
    </label>
    <div class="optHelp" id="s6-o0" hidden>
      <p><strong>Miks kriitiline:</strong> isegi â€œheaâ€ nÃµue vÃµib ebaÃµnnestuda, kui tÃ¤htaeg on mÃ¶Ã¶das.</p>
      <p class="muted"><strong>Tip:</strong> koosta kuupÃ¤evade kronoloogia ja kontrolli, millal nÃµue muutus sissenÃµutavaks.</p>
    </div>

  </fieldset>

  <footer class="step__nav">
    <button type="button" class="btn" data-action="back">Tagasi</button>
    <button type="button" class="btn btn-primary" data-action="finish">Vaata tulemust</button>
  </footer>
</article>

  </section>

<!-- RESULTS -->
<section class="results" id="results" aria-label="Tulemus" hidden>

  <header class="results__head">
    <h2>Tulemus</h2>
<p class="muted">
  See hinnang vÃµtab kokku Sinu vastused. KÃµige suurema mÃµjuga on tÃµendid ja aegumisoht.
</p>
  </header>

  <!-- Overall -->
  <div class="card overall" id="overallCard" data-level="unknown">
    <div class="overall__badge" id="overallBadge" aria-label="Ãœldhinnangu indikaator">â€”</div>
    <div class="overall__text">
      <div class="overall__title" id="overallTitle">Ãœldine riskiprofiil</div>
      <div class="overall__desc" id="overallDesc">
        TÃ¤ida kÃ¼simustik, et kuvada hinnang.
      </div>
    </div>
  </div>

  <!-- Grid (2x3) -->
  <div class="grid grid-2x3" id="riskGrid">

    <div class="card metric" id="m-basis" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">NÃµude sisu</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-basis-label">â€”</div>
      <div class="metric__note" id="m-basis-note">â€”</div>
    </div>

    <div class="card metric" id="m-breach" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">TÃ¤itmata jÃ¤tmine</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-breach-label">â€”</div>
      <div class="metric__note" id="m-breach-note">â€”</div>
    </div>

    <div class="card metric" id="m-damage" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">Summa</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-damage-label">â€”</div>
      <div class="metric__note" id="m-damage-note">â€”</div>
    </div>

    <div class="card metric" id="m-defenses" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">Vastuargumendid</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-defenses-label">â€”</div>
      <div class="metric__note" id="m-defenses-note">â€”</div>
    </div>

    <div class="card metric metric--weighted" id="m-evidence" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">TÃµendid</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-evidence-label">â€”</div>
      <div class="metric__note" id="m-evidence-note">â€”</div>
    </div>

    <div class="card metric metric--weighted" id="m-limitation" data-level="unknown">
      <div class="metric__head">
        <div class="metric__name">Aegumisoht</div>
        <div class="metric__dot"></div>
      </div>
      <div class="metric__label" id="m-limitation-label">â€”</div>
      <div class="metric__note" id="m-limitation-note">â€”</div>
    </div>

  </div>

  <!-- Info notice -->
  <div class="notice notice--neutral results__note">
    Tegemist on informatiivse eelanalÃ¼Ã¼siga ega asenda ÃµigusnÃµustamist.
  </div>

  <!-- Actions -->
  <div class="actions">
    <button type="button" class="btn" id="btnPlanOpen">
      Ava tÃ¶Ã¶plaan
    </button>
    <button type="button" class="btn" id="btnEdit">
      Muuda vastuseid
    </button>
    <button type="button" class="btn secondary" id="btnResetBottom">
      LÃ¤htesta
    </button>
  </div>

  <!-- II FAAS: Action plan -->
  <section class="card" id="actionPlanCard" hidden>

    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
      <h3 style="margin:0;">Soovituslik tÃ¶Ã¶plaan</h3>
      <button type="button" class="btn secondary" id="btnPlanClose">
        Sulge
      </button>
    </div>

    <p class="muted">
      Kuvatakse ainult need plokid, kus esines nÃµrk vÃµi kriitiline riskikoht.
    </p>

    <div class="notice" id="planConditions">
      <strong>Enne edasist sammu</strong>
      <ul class="list" id="planConditionsList"></ul>
    </div>

    <div id="planBlocks" style="margin-top:16px;"></div>

    <p class="muted small" style="margin-top:14px;">
      MÃ¤rkus: kÃ¤esolev tÃ¶Ã¶plaan on informatiivne ega kujuta endast ÃµigusnÃµustamist.
    </p>

  </section>

</section>

<footer class="footer">
  <p class="small muted">
    Â© 2026 OÃœ Solvere (Solvere Lab). KÃµik Ãµigused kaitstud.
  </p>
</footer>

</main>

<script>
(() => {
  const STORAGE_KEY = "solverelab_claim_precheck_v1";
    // --- Plausible events (ET)
  function track(name, props = {}) {
    try {
      if (typeof window.plausible === "function") {
        window.plausible(name, { props });
      }
    } catch (e) {}
  }

  const TRACK_CTX = { lang: "et", tool: "claim_precheck" };

  // ---- Elements
  const stepsWrap = document.getElementById("steps");
  const steps = Array.from(document.querySelectorAll(".step"));
  const results = document.getElementById("results");

  const btnStart = document.getElementById("btnStart");
  const btnEdit = document.getElementById("btnEdit");
  const btnResetBottom = document.getElementById("btnResetBottom");

  const progressFill = document.getElementById("progressFill");
  const progressLabel = document.getElementById("progressLabel");
  const progressBar = document.querySelector(".progressbar");

  const overallCard = document.getElementById("overallCard");
  const overallBadge = document.getElementById("overallBadge");
  const overallTitle = document.getElementById("overallTitle");
  const overallDesc = document.getElementById("overallDesc");

  // Grid card elements
  const gridIds = {
    basis:    { card: "m-basis",     label: "m-basis-label",     note: "m-basis-note" },
    breach:   { card: "m-breach",    label: "m-breach-label",    note: "m-breach-note" },
    damage:   { card: "m-damage",    label: "m-damage-label",    note: "m-damage-note" },
    defenses: { card: "m-defenses",  label: "m-defenses-label",  note: "m-defenses-note" },
    evidence: { card: "m-evidence",  label: "m-evidence-label",  note: "m-evidence-note" },
    limitation:{card: "m-limitation",label: "m-limitation-label",note: "m-limitation-note" },
  };

  // ---- Model (names match radio groups)
  const FIELDS = ["basis", "breach", "damage", "evidence", "defenses", "limitation"];

  // Weights: evidence & limitation are double-weighted
  const WEIGHTS = {
    basis: 1,
    breach: 1,
    damage: 1,
    defenses: 1,
    evidence: 2,
    limitation: 2,
  };

  // Critical â€œhard constraintsâ€
  const CRITICAL_FIELDS = ["evidence", "limitation"]; // if 0, cannot be Strong; both 0 => Weak

  // Component labels + 1-line notes (based on score 0-3)
const COMPONENT_TEXT = {
  basis: {
    3: { label: "Tugev", note: "On selge, mida teine pool pidi tegema, ja see on kirjalikult vÃµi hÃ¤sti tÃµendatav." },
    2: { label: "Piisav", note: "Kokkulepe/kohustus on olemas, kuid selle tÃ¤psus vÃµi vorm vajab tÃ¤psustamist." },
    1: { label: "NÃµrk",  note: "Kokkuleppe tingimused (mis, millal, kui palju) ei ole piisavalt selged." },
    0: { label: "Kriitiline", note: "Puudub selge alus, millele nÃµue toetub, vÃµi seda ei Ãµnnestu esialgu tuvastada." },
  },

  breach: {
    3: { label: "Tugev", note: "On selge, kuidas kokkulepet ei tÃ¤idetud (vÃµi tÃ¤ideti puudulikult/hilinemisega) ja see on tÃµendatav." },
    2: { label: "Piisav", note: "TÃ¤itmata jÃ¤tmine on usutav, kuid vajab paremat kirjeldust vÃµi lisatÃµendeid." },
    1: { label: "NÃµrk",  note: "TÃ¤itmata jÃ¤tmine vÃµib olla vaieldav (nt tingimused vÃµi kvaliteet on ebaselged)." },
    0: { label: "Kriitiline", note: "Ei ole selge, kas ja kuidas kokkulepet rikuti." },
  },

  damage: {
    3: { label: "Tugev", note: "NÃµude summa on selge, arvutatav ja dokumentidega pÃµhjendatav." },
    2: { label: "Piisav", note: "Summa on hinnanguliselt kokku pandav, kuid arvutuskÃ¤ik vÃµi dokumendid vajavad tÃ¤iendamist." },
    1: { label: "NÃµrk",  note: "Summa ei ole piisavalt selge vÃµi koosneb ebaselgetest osadest." },
    0: { label: "Kriitiline", note: "Summa ei ole praegu rahaliselt mÃ¤Ã¤ratletud." },
  },

  evidence: {
    3: { label: "Tugev", note: "Olemas on mitu tugevat tÃµendit, mis toetavad olulisi vÃ¤iteid." },
    2: { label: "Piisav", note: "MÃµned tÃµendid on olemas, kuid mitte kÃµigi oluliste vÃ¤idete kohta." },
    1: { label: "NÃµrk",  note: "TÃµendeid on vÃ¤he vÃµi need on pigem kaudsed." },
    0: { label: "Kriitiline", note: "Asjakohased tÃµendid puuduvad vÃµi ei toeta vÃ¤iteid piisavalt." },
  },

  defenses: {
    3: { label: "Tugev", note: "Tugevad vastuargumendid ei tundu tÃµenÃ¤olised." },
    2: { label: "Piisav", note: "MÃµni vastuargument on vÃµimalik ja vajab lÃ¤bimÃµtlemist." },
    1: { label: "NÃµrk",  note: "Vastuargumendid on tÃµenÃ¤olised ja vÃµivad oluliselt mÃµjutada tulemust." },
    0: { label: "Kriitiline", note: "Vastuargumendid vÃµivad olla tugevad ja tÃµenditega toetatud." },
  },

  limitation: {
    3: { label: "Tugev", note: "Aegumisoht ei paista esialgu olemas olevat ja kuupÃ¤evad on selged." },
    2: { label: "Piisav", note: "Aegumisoht on ebatÃµenÃ¤oline, kuid kuupÃ¤evad vajavad kontrolli." },
    1: { label: "NÃµrk",  note: "Aegumisoht on vÃµimalik ja vajab kiiret kontrolli." },
    0: { label: "Kriitiline", note: "Aegumisoht on tÃµenÃ¤oline ja vÃµib nÃµude maksmapanekut oluliselt piirata." },
  },
};

  // Overall labels (no percentages shown)
 const OVERALL_TEXT = {
  strong: {
    badge: "ğŸŸ¢",
    title: "Ãœldpilt: hea vÃ¤ljavaade",
    desc: "Sinu vastuste pÃµhjal on pÃµhipunktid (nÃµude sisu, tÃ¤itmata jÃ¤tmine, summa, tÃµendid ja aeg) Ã¼ldjoontes selged. JÃ¤rgmine samm on koondada dokumendid ja sÃµnastada nÃµue faktiliselt."
  },
  moderate: {
    badge: "ğŸŸ¡",
    title: "Ãœldpilt: vaja tÃ¤psustada",
    desc: "MÃµnes olulises kohas on ebakindlus. Enne kohtuteed tasub tÃ¤psustada kokkuleppe sisu, kuupÃ¤evad ja/vÃµi koguda lisatÃµendeid, et vÃ¤hendada vaidluse riski."
  },
  weak: {
    badge: "ğŸ”´",
    title: "Ãœldpilt: kÃµrge risk",
    desc: "Esineb kriitilisi puudusi (nt tÃµendid, aegumisoht vÃµi nÃµude sisu on ebaselge). Enne edasist sammu on mÃµistlik teha tÃ¶Ã¶plaani jÃ¤rgi selgitused ja dokumentide koondamine â€” muidu vÃµib vaidlus olla ebamÃµistlikult riskantne."
  },
};

  // ---- State
  let currentStep = 1;

  // ---- Helpers
  function qs(sel, root = document) { return root.querySelector(sel); }
  function qsa(sel, root = document) { return Array.from(root.querySelectorAll(sel)); }

  function getSaved() {
    try {
      const raw = sessionStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : {};
    } catch {
      return {};
    }
  }

  function save(data) {
    sessionStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  }

  function clearSaved() {
    sessionStorage.removeItem(STORAGE_KEY);
  }

  function setProgress(step) {
    const pct = Math.round((step - 1) / 6 * 100);
    progressFill.style.width = pct + "%";
    progressLabel.textContent = `Samm ${step} / 6`;
    progressBar.setAttribute("aria-valuenow", String(step - 1));
  }

  function showStep(n) {
    currentStep = n;

    stepsWrap.hidden = false;
    results.hidden = true;

    steps.forEach(s => s.hidden = (Number(s.dataset.step) !== n));

    setProgress(n);

    stepsWrap.scrollIntoView({ behavior: "smooth", block: "start" });
  }

  function showResults() {
    stepsWrap.hidden = false;
    steps.forEach(s => s.hidden = true);

    results.hidden = false;

    progressFill.style.width = "100%";
    progressLabel.textContent = "Samm 6 / 6";
    progressBar.setAttribute("aria-valuenow", "6");

    results.scrollIntoView({ behavior: "smooth", block: "start" });
  }

  function getSelectedValue(field) {
    const el = qs(`input[name="${field}"]:checked`);
    if (!el) return null;
    const v = Number(el.value);
    return Number.isFinite(v) ? v : null;
  }

  function setSelectedValue(field, value) {
    const el = qs(`input[name="${field}"][value="${value}"]`);
    if (el) el.checked = true;
  }

  function validateStepAnswered(stepNumber) {
    const stepEl = steps.find(s => Number(s.dataset.step) === stepNumber);
    if (!stepEl) return true;

    const radio = qs('input[type="radio"]', stepEl);
    if (!radio) return true;

    const field = radio.name;
    const v = getSelectedValue(field);
    return v !== null;
  }

  function fieldForStep(stepNumber) {
    const stepEl = steps.find(s => Number(s.dataset.step) === stepNumber);
    if (!stepEl) return null;
    const radio = qs('input[type="radio"]', stepEl);
    return radio ? radio.name : null;
  }

  function resumeFromAnswers(saved) {
    // Find first unanswered step
    for (let i = 1; i <= 6; i++) {
      const field = fieldForStep(i);
      if (!field) continue;
      if (saved[field] === undefined || saved[field] === null) return i;
    }
    return 6; // all answered -> last step
  }

  // ---- Scoring
  function computeModel(scores) {
    // Weighted sum
    let weightedSum = 0;
    let maxSum = 0;

    for (const f of FIELDS) {
      const w = WEIGHTS[f] ?? 1;
      const v = scores[f];
      weightedSum += v * w;
      maxSum += 3 * w;
    }

    const ratio = maxSum > 0 ? (weightedSum / maxSum) : 0;

    // Critical constraints
    const crit0 = CRITICAL_FIELDS.filter(f => scores[f] === 0).length;

    // Base band by ratio (not shown to user)
    let band = "moderate";
    if (ratio >= 0.75) band = "strong";
    else if (ratio < 0.5) band = "weak";
    else band = "moderate";

    // Apply constraints
    if (crit0 >= 2) band = "weak";
    else if (crit0 >= 1 && band === "strong") band = "moderate";

    return { band, ratio };
  }

  function levelFromScore(score) {
    // map 0-3 to UI level token
    if (score === 3) return "strong";
    if (score === 2) return "moderate";
    if (score === 1) return "weak";
    return "critical";
  }

  function renderDashboard(scores) {
    // Overall
    const { band } = computeModel(scores);

    const o = OVERALL_TEXT[band];
    overallBadge.textContent = o.badge;
    overallTitle.textContent = o.title;
    overallDesc.textContent = o.desc;

    overallCard.dataset.level = band;

    // Components
    for (const f of FIELDS) {
      const score = scores[f];
      const t = COMPONENT_TEXT[f][score];

      const ids = gridIds[f];
      const card = document.getElementById(ids.card);
      const label = document.getElementById(ids.label);
      const note = document.getElementById(ids.note);

      label.textContent = t.label;
      note.textContent = t.note;

      // dataset level can be styled in CSS
      card.dataset.level = levelFromScore(score);
    }
  }

  // ---- Persistence
  function readAllAnswersFromDOM() {
    const out = {};
    for (const f of FIELDS) {
      const v = getSelectedValue(f);
      if (v !== null) out[f] = v;
    }
    return out;
  }

  function applySavedToDOM(saved) {
    for (const f of FIELDS) {
      const v = saved[f];
      if (v === 0 || v === 1 || v === 2 || v === 3) {
        setSelectedValue(f, v);
      }
    }
  }

  function allAnswered(saved) {
    return FIELDS.every(f => (saved[f] === 0 || saved[f] === 1 || saved[f] === 2 || saved[f] === 3));
  }

  // Save on answer change
  function bindAnswerPersistence() {
    document.addEventListener("change", (e) => {
      const inp = e.target;
      if (!(inp instanceof HTMLInputElement)) return;
      if (inp.type !== "radio") return;

      const field = inp.name;
      if (!FIELDS.includes(field)) return;

      const saved = getSaved();
      saved[field] = Number(inp.value);
      save(saved);
     
      track("tool_answer", { ...TRACK_CTX, field, value: Number(inp.value) }); 
    });
  }

  // ---- UI events
  function resetAll() {
    qsa('input[type="radio"]').forEach(i => (i.checked = false));
    clearSaved();

    progressFill.style.width = "0%";
    progressLabel.textContent = "Samm 0 / 6";
    progressBar.setAttribute("aria-valuenow", "0");

    results.hidden = true;
    stepsWrap.hidden = true;

    // reset cards
    overallCard.dataset.level = "unknown";
    overallBadge.textContent = "â€”";
    overallTitle.textContent = "Ãœldpilt";
overallDesc.textContent = "Vasta kÃ¼simustele, et nÃ¤ha kokkuvÃµtvat hinnangut ja soovituslikku tÃ¶Ã¶plaani.";

for (const f of FIELDS) {
  const ids = gridIds[f];
  const card = document.getElementById(ids.card);
  document.getElementById(ids.label).textContent = "â€”";
  document.getElementById(ids.note).textContent = "â€”";
  card.dataset.level = "unknown";
}

// âœ… Reset Start button label
btnStart.textContent = "Alusta analÃ¼Ã¼si";

document.getElementById("app").scrollIntoView({ behavior: "smooth", block: "start" });
}

  function bindNavAndInfo() {
    document.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;

       // Help toggles (question-level + option-level)
      if (btn.classList.contains("helpBtn")) {
        const helpId = btn.getAttribute("data-help");
        const panel = document.getElementById(helpId);
        if (!panel) return;

        const expanded = btn.getAttribute("aria-expanded") === "true";
        btn.setAttribute("aria-expanded", String(!expanded));
        panel.hidden = expanded;
        return;
      }

      const action = btn.getAttribute("data-action");
      if (!action) return;

     if (action === "back") {
  track("tool_step_back", { ...TRACK_CTX, step: currentStep });
  if (currentStep > 1) showStep(currentStep - 1);
  return;
}

      if (action === "next") {
        if (!validateStepAnswered(currentStep)) {
          alert("Palun vali Ã¼ks vastusevariant, et jÃ¤tkata.");
          return;
        }
        track("tool_step_next", { ...TRACK_CTX, step: currentStep });
        if (currentStep < 6) showStep(currentStep + 1);
        return;
      }

      if (action === "finish") {
        if (!validateStepAnswered(currentStep)) {
          alert("Palun vali Ã¼ks vastusevariant, et kuvada tulemus.");
          return;
        }

        const saved = { ...getSaved(), ...readAllAnswersFromDOM() };
        save(saved);

        if (!allAnswered(saved)) {
          alert("Palun vasta kÃµigile plokkidele, et kuvada tulemus.");
          // jump to first unanswered
          const step = resumeFromAnswers(saved);
          showStep(step);
          return;
        }

        renderDashboard(saved);
        track("tool_finish", TRACK_CTX);
        showResults();
        return;
      }
    });
  }

// ---- Start / Resume
function hasAnyAnswers(saved){
  if (!saved) return false;
  return FIELDS.some(f => saved[f] === 0 || saved[f] === 1 || saved[f] === 2 || saved[f] === 3);
}

function initFromStorage() {
  const saved = getSaved();

  // Update Start button label based on saved state
  if (hasAnyAnswers(saved)) {
    btnStart.textContent = "JÃ¤tka analÃ¼Ã¼si";
  } else {
    btnStart.textContent = "Alusta analÃ¼Ã¼si";
  }

  if (!saved || Object.keys(saved).length === 0) return;

  applySavedToDOM(saved);

  // Resume to first unanswered step (or step 6 if all answered)
  const step = resumeFromAnswers(saved);
  stepsWrap.hidden = false;
  showStep(step);

  // If previously finished, show results immediately
  if (allAnswered(saved) && saved.__finished === true) {
    renderDashboard(saved);
    showResults();
  }
}

  // Mark finished when results shown
  function markFinished() {
    const saved = getSaved();
    saved.__finished = true;
    save(saved);
  }

  // Hook â€œfinishâ€ moment to mark finished
  const _showResults = showResults;
  showResults = function() {
    markFinished();
    _showResults();
  };

  // ---- Bind buttons
  btnStart.addEventListener("click", () => {
  track("tool_start", TRACK_CTX);
  showStep(1);
});
  btnEdit?.addEventListener("click", () => showStep(1));
 btnResetBottom?.addEventListener("click", () => {
  track("tool_reset", TRACK_CTX);
  resetAll();
});

  bindNavAndInfo();
  bindAnswerPersistence();
  initFromStorage();

    // --- II FAAS: Action plan generator (uses I faasi scores) ---
  const btnPlanOpen = document.getElementById("btnPlanOpen");
  const btnPlanClose = document.getElementById("btnPlanClose");
  const actionPlanCard = document.getElementById("actionPlanCard");
  const planBlocks = document.getElementById("planBlocks");
  const planConditionsList = document.getElementById("planConditionsList");

  function decisionConditionsFromScores(scores){
    const out = [];

    if (scores.limitation <= 1) out.push("Aegumise kÃ¼simus vajab kontrolli.");
    if (scores.evidence <= 1) out.push("TÃµendibaasi tuleb tÃ¤iendada.");
    if (scores.basis <= 1 || scores.breach <= 1 || scores.damage <= 1){
      const parts = [];
      if (scores.basis <= 1) parts.push("alus");
      if (scores.breach <= 1) parts.push("rikkumine");
      if (scores.damage <= 1) parts.push("kahju");
      out.push(`NÃµude sisu vajab tÃ¤psustamist: ${parts.join(", ")}.`);
    }
    if (scores.defenses === 0) out.push("VastuvÃ¤idete kÃ¤sitlus on vajalik.");

    // max 3
    return out.slice(0, 3);
  }

 const TASKS = {
  basis: {
    title: "NÃµude alus",
    items: [
      "Kirjuta Ã¼he lausega Ã¼les: kes pidi midagi tegema, mida tÃ¤pselt pidi tegema ja millal pidi tegema.",
      "Pane kirja, millele see kohustus tugines (nt leping, kokkulepe, kirjavahetus, seadus).",
      "Kirjelda 3â€“5 lÃ¼hilausena, mis oli kohustuse sisu (ilma hinnangute ja oletusteta).",
      "MÃµtle, mida Sa tegelikult nÃµuad (nt raha, kohustuse tÃ¤itmist, kahju hÃ¼vitamist).",
    ],
  },

  breach: {
    title: "Rikkumine",
    items: [
      "Kirjelda faktina, mida tehti valesti, hilinemisega vÃµi jÃ¤eti tegemata.",
      "Seo rikkumine konkreetse kohustusega (st millist lubadust vÃµi kokkulepet ei tÃ¤idetud).",
      "Koosta lihtne kronoloogia: kuupÃ¤ev, mis toimus, millest see selgub (nt e-kiri, arve, sÃµnum).",
    ],
  },

  damage: {
    title: "Kahju",
    items: [
      "Pane kirja, millest nÃµude summa koosneb.",
      "Kirjuta lahti arvutuskÃ¤ik (nt summa Ã— periood, konkreetne arve, kuludokumendid).",
      "Erista: tegelik kahju ning hinnangulised vÃµi tulevased kulud.",
      "MÃµtle lÃ¤bi, miks just see rikkumine kahju tekitas (st kuidas rikkumine viis rahalise kaotuseni).",
    ],
  },

  evidence: {
    title: "TÃµendid",
    items: [
      "Koosta nimekiri olemasolevatest tÃµenditest (nt leping, kirjavahetus, arve, akt, foto).",
      "MÃ¤rgi iga tÃµendi juurde, millist vÃ¤idet see kinnitab (nt kohustuse olemasolu, rikkumise toimumine, kahju suurus).",
      "MÃµtle, kas mÃµne olulise vÃ¤ite kohta on tÃµend puudu.",
      "Koonda failid Ã¼htsesse loogilisse struktuuri (nt kaustad vÃµi failinimed).",
    ],
  },

  defenses: {
    title: "VastuvÃ¤ited",
    items: [
      "MÃµtle, millistele vÃ¤idetele teine pool vÃµiks vastu vaielda.",
      "Pane kirja 2â€“3 kÃµige tÃµenÃ¤olisemat vastuvÃ¤idet.",
      "Kirjuta iga vastuvÃ¤ite juurde lÃ¼hike vastus (fakt + olemasolev tÃµend).",
      "MÃ¤rgi, milline vastuvÃ¤ide tundub Sulle kÃµige nÃµrgem koht.",
    ],
  },

  limitation: {
    title: "Aegumine",
    items: [
      "Pane kirja olulised kuupÃ¤evad: millal kokkulepe sÃµlmiti, millal rikkumine toimus, millal kahju ilmnes, millal teist poolt teavitati (kui teavitati).",
      "MÃµtle, millal nÃµue muutus tegelikult sissenÃµutavaks (st hetk, mil teisel poolel oleks tulnud kohustus tÃ¤ita).",
      "Kontrolli, kas vahepeal toimus midagi, mis vÃµis aega mÃµjutada (nt kirjavahetus, osaline tasumine, lÃ¤birÃ¤Ã¤kimised).",
      "MÃµtle, kas Sinu juhtum vÃµib kuuluda valdkonda, kus tÃ¤htajad on tavapÃ¤rasest erinevad (nt tÃ¶Ã¶-, Ã¼Ã¼ri- vÃµi tarbijavaidlus).",
      "Kui Sa ei ole kindel, on mÃµistlik seda kÃ¤sitleda riskina ja arvestada sellega edasiste sammude planeerimisel.",
    ],
  },
};

  function renderActionPlan(scores){
    // Clear
    planBlocks.innerHTML = "";
    planConditionsList.innerHTML = "";

    // Conditions
    const conds = decisionConditionsFromScores(scores);
    if (conds.length === 0){
      const li = document.createElement("li");
      li.textContent = "Kriitilisi tingimusi ei tuvastatud. Vajadusel tÃ¤psusta Ã¼ksikuid detaile enne edasist sammu.";
      planConditionsList.appendChild(li);
    } else {
      for (const c of conds){
        const li = document.createElement("li");
        li.textContent = c;
        planConditionsList.appendChild(li);
      }
    }

    // Blocks: only for <= 1
    const order = ["basis","breach","damage","evidence","defenses","limitation"];
    for (const key of order){
      if (scores[key] > 1) continue;

      const block = document.createElement("div");
      block.className = "qblock";
      block.style.marginTop = "12px";

      const h = document.createElement("h3");
      h.className = "qtitle";
      h.textContent = TASKS[key].title;

      const ul = document.createElement("ul");
      ul.className = "list";
      ul.style.margin = "8px 0 0 18px";

      for (const item of TASKS[key].items){
        const li = document.createElement("li");
        li.textContent = item;
        ul.appendChild(li);
      }

      block.appendChild(h);
      block.appendChild(ul);
      
        // Lisa viivisekalkulaatori link ainult "Kahju" plokki
  if (key === "damage") {
    const p = document.createElement("p");
    p.className = "muted small";
    p.style.marginTop = "8px";
    p.innerHTML = `
      Vajadusel saad viivise ja intressi arvutada
      <a href="https://viivisekalkulaator.ee/calculator/debt"
         target="_blank" rel="noopener">
        viivisekalkulaator.ee lehel
      </a>.
    `;
    block.appendChild(p);
  }
      
      planBlocks.appendChild(block);
    }
  }

  function openPlan(){
    const saved = getSaved();
    if (!saved) return;

    // scores are saved as numbers 0-3 already
    const scores = {};
    for (const f of FIELDS){
      scores[f] = Number(saved[f]);
    }

    renderActionPlan(scores);
    actionPlanCard.hidden = false;
    actionPlanCard.scrollIntoView({ behavior: "smooth", block: "start" });
  }

  function closePlan(){
    actionPlanCard.hidden = true;
  }

  btnPlanOpen?.addEventListener("click", () => {
  track("tool_plan_open", TRACK_CTX);
  openPlan();
});
  btnPlanClose?.addEventListener("click", closePlan);
})();
</script>


</body>
</html>
